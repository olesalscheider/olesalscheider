Upstream: https://github.com/tvheadend/tvheadend/pull/622

From c8aec9cc4ca1b810e9bffd6779b4898b18a469e8 Mon Sep 17 00:00:00 2001
From: Niels Ole Salscheider <niels_ole@salscheider-online.de>
Date: Mon, 6 Apr 2015 14:13:43 +0200
Subject: [PATCH] Use $PKG_CONFIG instead of pkg-config

This allows to use prefixed versions of pkg-config for cross-compilation.
---
 configure             |  2 +-
 support/configure.inc | 10 +++++-----
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/configure b/configure
index 912ddea..fd30e46 100755
--- a/configure
+++ b/configure
@@ -328,7 +328,7 @@ else
   if enabled_or_auto libav; then
     has_libav=true
 
-    ffmpeg=$(pkg-config --modversion libavcodec | cut -d '.' -f 3)
+    ffmpeg=$(${PKG_CONFIG} --modversion libavcodec | cut -d '.' -f 3)
     test -z "$ffmpeg" && ffmpeg=0
     printf "$TAB" "checking for ffmpeg libraries ..."
     if test $ffmpeg -lt 100; then
diff --git a/support/configure.inc b/support/configure.inc
index f7cfcd3..7c878fd 100755
--- a/support/configure.inc
+++ b/support/configure.inc
@@ -204,11 +204,11 @@ check_pkg ()
 
   printf "$TAB" "checking for pkg $pkg $ver ..."
 
-  dver=$(pkg-config --modversion $pkg 2> /dev/null)
+  dver=$(${PKG_CONFIG} --modversion $pkg 2> /dev/null)
   test -z "$dver" && dver="<none>"
 
   # Check for package
-  if pkg-config $pkg $cver; then
+  if ${PKG_CONFIG} $pkg $cver; then
     echo "ok (detected ${dver})"
     enable_pkg $pkg
   else
@@ -416,7 +416,7 @@ print_config ()
   # Packages
   echo "Packages:"
   for pkg in ${PACKAGES[*]}; do
-    printf "$fmt" "${pkg}" "$(pkg-config --modversion $pkg)"
+    printf "$fmt" "${pkg}" "$(${PKG_CONFIG} --modversion $pkg)"
   done
   echo ""
   
@@ -478,8 +478,8 @@ EOF
   # Add package config
   for pkg in ${PACKAGES[*]}; do
     cat >>"${CONFIG_MK}" <<EOF
-LDFLAGS += $(pkg-config --libs $pkg)
-CFLAGS  += $(pkg-config --cflags $pkg)
+LDFLAGS += $(${PKG_CONFIG} --libs $pkg)
+CFLAGS  += $(${PKG_CONFIG} --cflags $pkg)
 EOF
   done
 
-- 
2.3.2

